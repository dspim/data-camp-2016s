<!DOCTYPE html>
<html>
<head>
  <title>Case Study</title>

  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="generator" content="pandoc" />



  <meta name="date" content="2016-06-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <link rel="stylesheet" media="all" href="index_files/ioslides-13.5.1/fonts/fonts.css">

  <link rel="stylesheet" media="all" href="index_files/ioslides-13.5.1/theme/css/default.css">
  <link rel="stylesheet" media="only screen and (max-device-width: 480px)" href="index_files/ioslides-13.5.1/theme/css/phone.css">

  <base target="_blank">

  <script type="text/javascript">
    var SLIDE_CONFIG = {
      // Slide settings
      settings: {
                title: 'Case Study',
                        useBuilds: true,
        usePrettify: true,
        enableSlideAreas: true,
        enableTouch: true,
                      },

      // Author information
      presenters: [
            {
        name:  'Lin @ NCCU Data Camp' ,
        company: '',
        gplus: '',
        twitter: '',
        www: '',
        github: ''
      },
            ]
    };
  </script>

  <style type="text/css">

    b, strong {
      font-weight: bold;
    }

    em {
      font-style: italic;
    }

    slides > slide {
      -webkit-transition: all 0.4s ease-in-out;
      -moz-transition: all 0.4s ease-in-out;
      -o-transition: all 0.4s ease-in-out;
      transition: all 0.4s ease-in-out;
    }

    .auto-fadein {
      -webkit-transition: opacity 0.6s ease-in;
      -webkit-transition-delay: 0.4s;
      -moz-transition: opacity 0.6s ease-in 0.4s;
      -o-transition: opacity 0.6s ease-in 0.4s;
      transition: opacity 0.6s ease-in 0.4s;
      opacity: 0;
    }

  </style>

  <link rel="stylesheet" href="css/dsp.css" type="text/css" />

  <script src="index_files/htmlwidgets-0.6/htmlwidgets.js"></script>
  <script src="index_files/jquery-1.11.1/jquery.min.js"></script>
  <script src="index_files/underscore-1.8.3/underscore-min.js"></script>
  <script src="index_files/highcharts-4.2.3/highstock.js"></script>
  <script src="index_files/highcharts-4.2.3/highcharts-more.js"></script>
  <script src="index_files/highcharts-4.2.3/highcharts-3d.js"></script>
  <script src="index_files/highcharts-4.2.3/modules/exporting.js"></script>
  <script src="index_files/highcharts-4.2.3/modules/drilldown.js"></script>
  <script src="index_files/highcharts-4.2.3/modules/heatmap.js"></script>
  <script src="index_files/highcharts-4.2.3/modules/map.js"></script>
  <script src="index_files/highcharts-4.2.3/modules/treemap.js"></script>
  <script src="index_files/highcharts-4.2.3/modules/reset.js"></script>
  <script src="index_files/highcharts-4.2.3/plugins/draggable-points.js"></script>
  <script src="index_files/highcharts-4.2.3/plugins/pattern-fill-v2.js"></script>
  <script src="index_files/highcharts-4.2.3/plugins/text-symbols.js"></script>
  <link href="index_files/fontawesome-4.5.0/font-awesome.min.css" rel="stylesheet" />
  <script src="index_files/highchart-binding-0.2.0/highchart.js"></script>
  <script src="index_files/datatables-binding-0.1/datatables.js"></script>
  <script src="index_files/datatables-1.10.7/jquery.dataTables.min.js"></script>
  <link href="index_files/datatables-default-1.10.7/dataTables.extra.css" rel="stylesheet" />
  <link href="index_files/datatables-default-1.10.7/jquery.dataTables.min.css" rel="stylesheet" />

</head>

<body style="opacity: 0">

<slides class="layout-widescreen">

  <slide class="title-slide segue nobackground">
        <!-- The content of this hgroup is replaced programmatically through the slide_config.json. -->
    <hgroup class="auto-fadein">
      <h1 data-config-title><!-- populated from slide_config.json --></h1>
      <h2 data-config-subtitle><!-- populated from slide_config.json --></h2>
      <p data-config-presenter><!-- populated from slide_config.json --></p>
            <p style="margin-top: 6px; margin-left: -2px;">2016-06-30</p>
          </hgroup>
  </slide>

<slide class=''><hgroup><h2>About Me</h2></hgroup><article  id="about-me">

<div style="float:left;width:48%;">
<p><img src="img/lin.jpg" width="400px"></p></div>

<div style="float:left;width:48%;">
<h3>

Lin

</h3>

<p><br></p>

<ul>
<li>政大統計所碩二

<ul>
<li>健保資料庫</li>
<li>SQL Server、R</li>
</ul></li>
<li>Whoscall Data Analyst Intern

<ul>
<li>User Profiling</li>
<li>Data Dashboard</li>
</ul></li>
</ul></div>

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>Agenda</h2></hgroup><article  id="agenda">

</article></slide><slide class=''><hgroup><h2>Agenda</h2></hgroup><article  id="agenda-1">

<ul>
<li>Open Data</li>
<li>專案介紹與資料收集 (Review)</li>
<li>分群方法簡介</li>
<li>進階視覺化使用

<ul>
<li>空間資料視覺化 : ggmap</li>
<li>分群方法呈現：雷達圖</li>
<li>關連性分析 : Plotly</li>
</ul></li>
</ul>

</article></slide><slide class=''><hgroup><h2>Goal</h2></hgroup><article  id="goal">

<div class="columns-2">
<p><img src="img/pls.png" width="400px"></p>

<ul>
<li>地理、空間資料視覺化</li>
<li>進階圖表介紹</li>
</ul>

<p>善用網路資源、以及最強大的<code>help()</code></p></div>

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>研究主題：Power Analysis</h2></hgroup><article  id="power-analysis">

</article></slide><slide class=''><hgroup><h2>Open Data in Taiwan (+)</h2></hgroup><article  id="open-data-in-taiwan">

<p>英國「開放知識基金會」（Open Knowledge Foundation）的最新評比(20151209)，<a href='http://www.ettoday.net/news/20151209/610454.htm' title=''>2015年台灣在資料開放指數在全球149個評比國家中名列第一</a>，領先日本、美國德國、法國等先進國家。</p>

<p>Open Data對台灣來說 = 金礦</p>

<p>而擅長於資料分析的我們，職責就是不斷挖掘金礦，創造Open Data的價值。</p>

</article></slide><slide class=''><hgroup><h2>Open Data in Taiwan (-)</h2></hgroup><article  id="open-data-in-taiwan--">

<p>雖然臺灣 Open Data 排名第一，但還是有許多可以改善的地方：</p>

<ul>
<li>資料格式不統一

<ul>
<li>PDF, xls, csv</li>
</ul></li>
<li>資料不完整

<ul>
<li>時間、不易串檔</li>
</ul></li>
</ul>

<p>Open Data進行資料分析前，需要具備整理資料的能力 =&gt; 很好的訓練</p>

</article></slide><slide class=''><hgroup><h2>Power Analysis</h2></hgroup><article  id="power-analysis-1">

<div class="columns-2">
<p><img src="img/hot.jpg" width="400px"></p>

台北創入夏以來最高溫37度 用電吃緊亮「限電警戒」紅燈，隨著溫度升高，用電需求也持續增加、供電吃緊。<br><br>

<h3>

節電？從何節起？<br><br>

</h3>

<h3>

用電量與人口特質的關係？

</h3></div>

</article></slide><slide class=''><hgroup><h2>Power Analysis (2)</h2></hgroup><article  id="power-analysis-2">

<div style="float:left;width:48%;">
<p><img src = "img/think.jpg" width = "400px"></p></div>

<div style="float:left;width:48%;">
<h3>

你是否曾經思考過:<br>節電？從何節起？<br><br>

</h3>

<ul>
<li>臺灣的用電大戶地區有哪些呢？

<h3>

用電量與人口特質的關係？

</h3></li>
<li>用電量高低的背後，是否跟某些因素有關呢？</li>
</ul></div>

</article></slide><slide class=''><hgroup><h2>Power Analysis (3)</h2></hgroup><article  id="power-analysis-3">

<h3>

過去相關研究：

</h3>

<p><br></p>

<ul>
<li><a href='https://dspim.github.io/data-labs/Power_Preliminary' title=''>北市電力分析</a></li>
<li><a href='http://www.thenewslens.com/article/21324' title=''>台灣鄉鎮市區用電情況</a></li>
</ul>

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>手把手 Open Data 資料分析 開始！</h2></hgroup><article  id="-open-data--">

</article></slide><slide class=''><hgroup><h2>逃不過清資料的魔掌啦！</h2></hgroup><article >

<ul>
<li>清理資料花費將近 <strong>八成</strong> 的時間</li>
<li>練功練coding練頭腦<del>練脾氣</del>最好的方式</li>
<li>幸運如你，我們已經將<a href='https://github.com/unityculture/DSP2016_DataCamp/tree/master/data' title=''>資料打包</a>好啦！

<ul>
<li>20160426_data.csv：整理過後的資料</li>
<li>20160613_data_cluster.csv：經過指標選取、分群方法後的資料</li>
<li>20160613_Radar_plot.csv：用來繪製雷達圖的資料</li>
<li>20160617_plotly_data.csv : Plotly資料</li>
</ul></li>
<li>Homework

<ul>
<li>請同學參考<a href='#13' title=''>資料收集與整理 (3)</a>，將資料進行整理</li>
</ul></li>
</ul>

</article></slide><slide class=''><hgroup><h2>資料收集與整理 (1)</h2></hgroup><article  id="-1">

<div align="center">
<p><img src="img/datascource.png" width="800px"></p></div>

</article></slide><slide class=''><hgroup><h2>資料收集與整理 (2)</h2></hgroup><article  id="-2">

<div align="center">
<p><img src="img/datajoin.png" width="800px"></p></div>

</article></slide><slide class=''><hgroup><h2>資料收集與整理 (3)</h2></hgroup><article  id="-3" class="data3">

<p>將以下不同來源的資料按照村里進行串檔(JOIN)：</p>

<ul>
<li><a href='http://www.taipower.com.tw/content/announcement/ann01.aspx' title=''>台電電力資料</a></li>
<li><a href='http://data.gov.tw/node/17983' title=''>各村里綜合所得稅所得總額</a></li>
<li><a href='http://data.gov.tw/node/8411' title=''>各村里戶籍人口統計月報表</a></li>
<li><a href='http://data.gov.tw/node/8409' title=''>各村里教育程度資料</a></li>
</ul>

<blockquote>
<p>Note 1: 因為資料的時間涵蓋範圍不同，本研究取2014年進行分析(除所得資料未涵蓋，其他皆有）。</p>
</blockquote>

<blockquote>
<p>Note 2: 將2012年的各村里綜合所得稅總和資料作為2014年的推估，與其他資料進行串檔。</p>
</blockquote>

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>群集分析</h2></hgroup><article >

</article></slide><slide class=''><hgroup><h2>一句話形容群集分析？</h2></hgroup><article >

<br><br><br><br><br>

<div align="center">
<p><hh>近朱者赤，近墨者黑</hh></p></div>

</article></slide><slide class=''><hgroup><h2>為什麼我們需要群集分析？</h2></hgroup><article >

<p>將<strong>人口特性</strong>、<strong>用電量</strong>相似的村里合併</p>

<ul>
<li>觀察<strong>群</strong>較觀察<strong>值</strong>容易

<ul>
<li>如：<strong>所得高</strong>、<strong>年齡層低</strong>、<strong>單身</strong>、<strong>女性</strong></li>
</ul></li>
<li>描繪<strong>群的輪廓</strong>與用電量的關係</li>
</ul>

</article></slide><slide class=''><hgroup><h2>基本分群方法簡介</h2></hgroup><article >

<p>統計方法中常用的分群方法：</p>

<ul>
<li>Hierarchical Clustering</li>
<li>Center-based Clustering</li>
<li>Density-based Clustering</li>
</ul>

<div align="center">
<p><img src="img/rdata-mining-compare-clustering-1.png" width="600px"></p></div>

</article></slide><slide class=''><hgroup><h2>基本分群方法簡介</h2></hgroup><article  id="-1">

<p>分群方法不是這次的課程目標 <del>請報名下次的課程</del></p>

<ul>
<li><p>快速介紹本次所使用的<a href='http://cgm.cs.ntust.edu.tw/etrex/kMeansClustering/kMeansClustering2.html' title=''>K-means分群方法</a></p></li>
<li><p>若對分群方法有興趣，可以參考<a href='http://wush978.github.io/StatMLDM/slide/DataMining.html#22' title=''>Wush大大的神作</a></p></li>
</ul>

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>進階視覺化使用</h2></hgroup><article >

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<br><br><br><br><br>

<div align="center">
<p><hh>空間資料視覺化！？</hh></p></div>

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<div align="center">
<p><img src="img/hosp.png" width="600px"></p></div>

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<table class = 'rmdtable'>
<tr class="header">
<th align="left">縣市</th>
<th align="left">鄉鎮</th>
<th align="right">診所個數</th>
</tr>
<tr class="odd">
<td align="left">嘉義縣</td>
<td align="left">大林鎮</td>
<td align="right">11</td>
</tr>
<tr class="even">
<td align="left">台北市</td>
<td align="left">中正區</td>
<td align="right">70</td>
</tr>
<tr class="odd">
<td align="left">台中市</td>
<td align="left">北屯區</td>
<td align="right">120</td>
</tr>
<tr class="even">
<td align="left">桃園市</td>
<td align="left">桃園市</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">苗栗縣</td>
<td align="left">公館鄉</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">嘉義縣</td>
<td align="left">中埔鄉</td>
<td align="right">14</td>
</tr>
</table>

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<div align="center">
<img src="img/love.png" width="600px"> <br>

<h1>

好懂又漂亮多了，喜番～

</h1></div>

</article></slide><slide class=''><hgroup><h2>空間資料視覺化時機</h2></hgroup><article >

<p>我們時常會遇到具有空間資訊(如經緯度)的資料，如：</p>

<ul>
<li>台灣各縣市人口分布</li>
<li>台灣各縣市癌症發生率</li>
<li>國際航空熱門航班路線</li>
</ul>

<p>具有空間性的資料，可以藉由地理視覺化觀察現象。</p>

<h3>

提供一個不一樣的角度探索資料

</h3>

</article></slide><slide class=''><hgroup><h2>Example</h2></hgroup><article  id="example">

<ul>
<li>Source.airport : 航程起點</li>
<li>Destination.airport : 航程終點</li>
<li>n : 往返次數</li>
</ul>

<div align="center">
<h1>

看的出方向性？位置？

</h1></div>

<p><br></p>

<table class = 'rmdtable'>
<tr class="header">
<th align="left">Source.airport</th>
<th align="left">Destination.airport</th>
<th align="right">n</th>
</tr>
<tr class="odd">
<td align="left">SVX</td>
<td align="left">BKK</td>
<td align="right">26</td>
</tr>
<tr class="even">
<td align="left">XIY</td>
<td align="left">YTY</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="left">CDG</td>
<td align="left">TPE</td>
<td align="right">59</td>
</tr>
</table>

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<br><br><br>

<div align="center">
<p><img src="img/flights.jpg" width="1000px"></p></div>

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<br><br><br><br><br>

<div align="center">
<p>Q : 用什麼指標衡量用電量高低？<br> <hh>台北市每戶用電量概況？</hh></p></div>

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<div align="center">
<ul>
<li><img src="img/map1.png" width="400px"> + 疊 + <img src="img/map2.png" width="400px"></li>
</ul></div>

</article></slide><slide class=''><hgroup><h2>ggmap 套件介紹與安裝</h2></hgroup><article  id="ggmap-">

<p>ggmap 套件是用來繪製地圖的R套件，地圖的來源可以由Google、OpenstreetMap等下載。</p>

<p>並且可以結合 ggplot 套件來<strong>疊圖</strong></p>

<pre class = 'prettyprint lang-r'>install.packages(&#39;ggmap&#39;)</pre>

</article></slide><slide class=''><hgroup><h2>首先，你需要有一張底圖</h2></hgroup><article >

<ul>
<li><code>get_map</code> : 從 Google Map or Open Street Map(OSM) or .. 取得地圖</li>
<li><code>location</code> : 地圖的中心點, 可以放經緯度 or 地名

<ul>
<li>&quot;政治大學&quot;&quot;</li>
<li>c(lon = -95.3632715, lat = 29.7632836)</li>
</ul></li>
<li><code>zoom</code>： 比例尺, 整數1~21</li>
</ul>

<pre class = 'prettyprint lang-r'>library(ggmap)</pre>

<pre class = 'prettyprint lang-r'>map &lt;- get_map(location = c(121.546936,25.069758), zoom = 12, source = &#39;google&#39;, color = &#39;bw&#39;)
ggmap(ggmap = map)
## qmap(location=c(121.546936,25.069758), zoom=12, source = &#39;google&#39;, color = &#39;bw&#39;)</pre>

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" width="720" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>台灣村里界線圖整理</h2></hgroup><article >

<ul>
<li><a href='http://data.gov.tw/node/7438' title=''>台灣村里界線圖下載</a> <img src = "img/dl1.jpg" width = "400px"></li>
<li>注意編碼(Mac版)：<img src = "img/dl3.jpg" width = "400px"></li>
</ul>

</article></slide><slide class=''><hgroup><h2>套件安裝</h2></hgroup><article >

<ul>
<li>安裝<code>rgdal</code>、<code>rgeos</code>、<code>maptools</code>套件</li>
</ul>

<pre class = 'prettyprint lang-r'>install.packages(&#39;rgdal&#39;)
install.packages(&#39;maptools&#39;)
install.packages(&#39;rgeos&#39;)</pre>

</article></slide><slide class=''><hgroup><h2>台灣村里界線圖資料匯入</h2></hgroup><article >

<ul>
<li>sfn 格式為 <code>Large SpatialPolygon DataFrame</code></li>
<li>sfn有兩個重要的資料(要用<code>@</code>叫出來)

<ul>
<li>data 對應 <code>Village_NLSC_1050219.dbf</code> (縣市、鄉鎮、村里、及其ID)</li>
<li>polygon 對應 <code>Village_NLSC_1050219.shp</code> (用來描繪村里界線的資料)</li>
</ul></li>
<li><code>?readOGR</code> 查詢一下細節

<ul>
<li>dsn : 放置台灣村里界線圖資料夾的路徑</li>
<li>layer : 資料夾內檔案名稱(不包含副檔名<code>.xxx</code>)</li>
</ul></li>
</ul>

<pre class = 'prettyprint lang-r'>library(rgdal)
library(maptools)
library(ggplot2)
sfn &lt;- readOGR(dsn = &#39;..指定到下載下來檔案的路徑../村里界圖(TWD97經緯度)1050317/&#39;,
               layer=&#39;Village_NLSC_1050219&#39;, stringsAsFactors = F)</pre>

<pre class = 'prettyprint lang-r'>head(sfn@data)
sfn@polygons[[1]]</pre>

</article></slide><slide class=''><hgroup><h2>人生總是充滿挫折</h2></hgroup><article >

<p>其實玩OpenData一定會遇到許多奇形怪狀的問題</p>

<p>但不仿化挫折為契機！練習處理資料的能力</p>

<div align="center">
<p><img src="img/encoding.png" width="800px"></p></div>

</article></slide><slide class=''><hgroup><h2>曙光！</h2></hgroup><article >

<p>如前幾天的課程，如果出現亂碼該怎麼做？ (encoding = ?)</p>

<pre class = 'prettyprint lang-r'>head(sfn@data)</pre>

<pre >  OBJECTID  UID PRO_ID COUNTY_ID TOWN_ID  VILLAGE_ID V_Name T_Name C_Name
0     8573 7064     64        64 6401000 6401000-013 中興里 旗津區 高雄市
1     8578 3626     10     10007 1000712 1000712-006 頂潭里 田中鎮 彰化縣
2     8579 3627     10     10007 1000712 1000712-007 中潭里 田中鎮 彰化縣
3     8580 3628     10     10007 1000712 1000712-008 龍潭里 田中鎮 彰化縣
4     8581 3642     10     10007 1000712 1000712-022 大社里 田中鎮 彰化縣
5     8582 3737     10     10007 1000717 1000717-013 美雅村 社頭鄉 彰化縣
  Substitute
0     中興里
1     頂潭里
2     中潭里
3     龍潭里
4     大社里
5     美雅村</pre>

</article></slide><slide class=''><hgroup><h2>僅取出台北的界線地圖</h2></hgroup><article >

<p>因為專案是針對台北市進行分析，因此我們只需要台北市的村里界線。</p>

<ul>
<li><code>C_Name</code> : 為縣市名稱</li>
<li><code>Substitute</code>與<code>V_Name</code>的差別？

<ul>
<li>Try : <code>sfn@data %&gt;% filter(V_Name != Substitute) %&gt;% head</code></li>
<li>Ans : 村里名稱會因為中文編碼的關係無法顯示，<code>Substitute</code>為處理此問題後的欄位</li>
</ul></li>
<li><code>fortify</code> : 按照<code>行政區域</code>(鄉鎮+村里欄位)將<code>Large SpatialPolygon DataFrame</code>轉換成繪圖的格式</li>
</ul>

<pre class = 'prettyprint lang-r'>## 因為同一個縣市中會有相同名字的村里，為了避免Join出問題，建議加入鄉鎮名
sfn@data &lt;- sfn@data %&gt;% 
  mutate(行政區域 = paste0(T_Name,Substitute)) 
tp.v &lt;- sfn[sfn$C_Name == &#39;臺北市&#39;,] %&gt;% fortify(region = &#39;行政區域&#39;)</pre>

<pre class = 'prettyprint lang-r'>head(tp.v)</pre>

</article></slide><slide class=''><hgroup><h2>匯入整理過的電力資料</h2></hgroup><article >

<p><code>windows版本不用更改fileEncoding</code></p>

<ul>
<li><a href='https://github.com/unityculture/DSP2016_DataCamp/tree/master/data' title=''>20160426_data.csv下載位置</a></li>
</ul>

<pre class = 'prettyprint lang-r'># 別忘了先檢查以下流程喔！ setwd() getwd() head() tail() str() ...
## Mac版本 
data &lt;- read.csv(&#39;data/20160426_data.csv&#39;,fileEncoding = &#39;big-5&#39;)
tp.data &lt;- data %&gt;% filter(縣市 == &#39;臺北市&#39;,統計年月 == &#39;10407&#39;)
head(tp.data)</pre>

<pre >  統計年月   縣市     行政區域 售電量度數 教育程度總計 大學以上比例
1    10407 臺北市 北投區八仙里    2220263         4988       0.0910
2    10407 臺北市 北投區大同里    2469722         5492       0.0954
3    10407 臺北市 北投區大屯里     483488         1105       0.0588
4    10407 臺北市 北投區稻香里    1804821         4719       0.0799
5    10407 臺北市 北投區東華里    1586857         4005       0.1134
6    10407 臺北市 北投區豐年里    1359574         4097       0.0588
  大學比例 大學以下比例 納稅單位 綜合所得總額 綜合所得中位數 綜合所得IQR
1   0.3031       0.6059     1768      1860333            647         874
2   0.2930       0.6116     1934      2110861            649         919
3   0.2045       0.7367      346       498508            570         726
4   0.2823       0.6378     1579      1461138            629         756
5   0.3144       0.5723     1455      1568597            688         934
6   0.2670       0.6742     1399      1152844            604         724
  戶數 總人數 女性比例 男性比例 少年人口比例 青年人口比例 壯年人口比例
1 2109   5722   0.5108   0.4892       0.2008       0.3041       0.3827
2 2365   6283   0.5055   0.4943       0.2037       0.3002       0.3794
3  428   1256   0.4697   0.5303       0.1839       0.2914       0.3726
4 2032   5284   0.4970   0.5030       0.1781       0.3155       0.3847
5 1602   4680   0.5303   0.4697       0.2182       0.2795       0.3808
6 1723   4936   0.5142   0.4858       0.2297       0.3160       0.3381
  老年人口比例 出生數 出生數.男 出生數.女 結婚對數 離婚對數 設有戶籍宅數
1       0.1124     10         7         3        2        2         1519
2       0.1168     13         4         9        3        1         1784
3       0.1529      3         3         0        1        1          287
4       0.1219      7         2         5        4        3         1623
5       0.1216      7         2         5        3        2         1171
6       0.1163      9         4         5        4        1         1180
  設有戶籍宅數之平均人口數 單身或頂客家庭 核心家庭 折衷或大家庭 總戶長數
1                     3.77            610      463          446     2112
2                     3.53            736      565          483     2375
3                     4.38            123       67           97      429
4                     3.26            726      543          354     2043
5                     4.01            376      421          374     1604
6                     4.18            369      368          443     1712
  戶長平均年齡 少年戶長數 青年戶長數 壯年戶長數 老年戶長數
1        54.05         33        581       1065        433
2        54.25         52        636       1174        513
3        58.14          5         74        218        132
4        54.19         37        604        952        450
5        55.71         18        394        832        360
6        53.64         25        554        747        386
  每戶平均老年人口數 獨居老人宅數 一名老年人口宅數 二名以上老年人口宅數
1               0.32           95               73                   22
2               0.32          124               99                   25
3               0.47           38               30                    8
4               0.33          106               89                   17
5               0.36           68               44                   24
6               0.35           59               40                   19
  有偶人數 離婚人數 未婚人數 便利商店數 每戶平均用電度數 每人平均用電度數
1     1329      249      333          0          1052.76           388.02
2     1477      258      404          0          1044.28           393.08
3      280       46       55          0          1129.64           384.94
4     1233      220      357          0           888.20           341.56
5     1099      160      170          0           990.55           339.07
6     1094      200      229          1           789.07           275.44</pre>

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<br><br><br><br><br>

<div align="center">
<p><hh><strong>練習時間！！(10 Mins)</strong></hh></p></div>

</article></slide><slide class=''><hgroup><h2>確認兩者資料的村里格式是否一致</h2></hgroup><article >

<p><code>tp.data</code> 為取出符合<code>臺北市</code>、<code>104年07月</code>的資料(包含8月，雙月記錄)。</p>

<p>請試著確認:</p>

<p><strong>台北市用電量資料(tp.data)</strong>與<strong>台北市村里界線</strong>的<strong>村里欄位</strong>是否一致？</p>

<p>也就是說，要檢查：</p>

<ul>
<li>若台北市有456個村里，則tp.data與tp.v的村里都要有456個，且缺一不可</li>
<li><code>tp.data</code>與<code>tp.v</code>的村里的名稱要相同</li>
</ul>

</article></slide><slide class=''><hgroup><h2>參考答案</h2></hgroup><article >

<ul>
<li>發現村里界線資料為<code>糖[部]里</code> ≠ 電力資料的<code>糖部里</code></li>
</ul>

<pre class = 'prettyprint lang-r'>## tp.v的村里名稱是否都有出現在tp.data中？ 若有，把位置記錄下來
posi &lt;- which(! tp.v$id %in% tp.data$行政區域)
tp.v[posi,] %&gt;% head(1)</pre>

<pre >          long      lat order  hole piece             id            group
32303 121.4993 25.03528 32303 FALSE     1 萬華區糖[部]里 萬華區糖[部]里.1</pre>

<pre class = 'prettyprint lang-r'>## tp.data的村里名稱是否都有出現在tp.v中？ 若有，把位置記錄下來
posi &lt;- which(! tp.data$行政區域 %in% tp.v$id)
tp.data[posi,&#39;行政區域&#39;]</pre>

<pre >[1] 萬華區糖部里
456 Levels: 北投區八仙里 北投區大同里 北投區大屯里 ... 中正區忠勤里</pre>

</article></slide><slide class=''><hgroup><h2>參考答案 Cont.</h2></hgroup><article  id="-cont.">

<pre class = 'prettyprint lang-r'>## 發現除了糖部里，其他皆一致！
tp.v$id[tp.v$id == &#39;萬華區糖[部]里&#39;] &lt;- &#39;萬華區糖部里&#39;
## 在確任一次有沒有不一樣
which(! tp.v$id %in% tp.data$行政區域)</pre>

<pre >integer(0)</pre>

<pre class = 'prettyprint lang-r'>which(! tp.data$行政區域 %in% tp.v$id)</pre>

<pre >integer(0)</pre>

</article></slide><slide class=''><hgroup><h2>將村里界線資料與電力資料合併</h2></hgroup><article >

<ul>
<li>電力資料新增<code>村里</code>欄位。</li>
<li><p>僅挑選：(1)村里、(2)電力欄位 與村里界線資料合併即可</p></li>
<li><p><img src="img/joinb.jpg" width="400px"> + <strong>JOIN</strong> + <img src="img/joina.jpg" width="150px"></p></li>
</ul>

<pre class = 'prettyprint lang-r'>## 電力資料
power_data &lt;- tp.data %&gt;% select(行政區域,每戶平均用電度數)</pre>

<pre class = 'prettyprint lang-r'>## 村里資料
tp.v</pre>

</article></slide><slide class=''><hgroup><h2>將村里界線資料與電力資料合併</h2></hgroup><article  id="-1">

<pre class = 'prettyprint lang-r'>power_map &lt;- tp.v %&gt;% 
  merge(y = power_data, by.x = &#39;id&#39;, by.y = &#39;行政區域&#39;)
power_map %&gt;% head</pre>

<pre >            id     long      lat order  hole piece          group
1 北投區八仙里 121.5030 25.12405     1 FALSE     1 北投區八仙里.1
2 北投區八仙里 121.5030 25.12391     2 FALSE     1 北投區八仙里.1
3 北投區八仙里 121.5030 25.12351     3 FALSE     1 北投區八仙里.1
4 北投區八仙里 121.5030 25.12323     4 FALSE     1 北投區八仙里.1
5 北投區八仙里 121.5030 25.12294     5 FALSE     1 北投區八仙里.1
6 北投區八仙里 121.5029 25.12271     6 FALSE     1 北投區八仙里.1
  每戶平均用電度數
1          1052.76
2          1052.76
3          1052.76
4          1052.76
5          1052.76
6          1052.76</pre>

</article></slide><slide class=''><hgroup><h2>終於可以畫圖啦！</h2></hgroup><article >

<p>用力哭泣！！！ T &#8230; T</p>

<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" width="720" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<ul>
<li><code>geom_polygon</code> 會將相同<code>group</code>的<code>long</code>、<code>lat</code> 按照order連接起來</li>
<li><code>fill</code> : polygon的連接起來內部的顏色的深淺，會依照fill的大小來調整</li>
<li><code>scale_fill_gradient</code> : fill顏色的相關設定

<ul>
<li>low : fill最小值要填什麼顏色</li>
<li>high : fill最大值要填什麼顏色</li>
<li>limit : fill的範圍限制</li>
<li><a href='https://www.nceas.ucsb.edu/~frazier/RSpatialGuides/colorPaletteCheatsheet.pdf' title=''>顏色色碼參考</a></li>
</ul></li>
</ul>

<pre class = 'prettyprint lang-r'>bg &lt;- get_map(location = c(121.546936,25.069758), zoom = 12, maptype = &quot;toner&quot;)
ggmap(bg, extent = &quot;device&quot;) +
  geom_polygon(data = power_map, aes(x = long, y = lat, group = group, fill = 每戶平均用電度數),
               colour = &quot;black&quot;, size = 0.5) +
  scale_fill_gradient(low = &quot;#FFFFB2&quot;, high = &quot;#B10026&quot;,
                      limits = c(300, 2500)) +
  theme_bw(base_family = &#39;STHeiti&#39;) + 
  theme(axis.text = element_blank(), ## 移除經緯度
        axis.ticks = element_blank())</pre>

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>練習時間！打鐵趁修(燒)</h2></hgroup><article >

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<br><br><br><br><br>

<div align="center">
<p><hh>請每小組挑出台北市的任一個鄉鎮市區，繪製用電量地圖！</hh></p></div>

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<p><img src="index_files/figure-html/unnamed-chunk-21-1.png" width="720" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<pre class = 'prettyprint lang-r'>bg &lt;- get_map(location = c(121.5377993,25.0291208), zoom = 13, maptype = &quot;toner&quot;)
ggmap(bg, extent = &quot;device&quot;) +
  geom_polygon(data = power_map %&gt;% filter(substr(id,1,3)==&#39;大安區&#39;), 
               aes(x = long, y = lat, group = group, fill = 每戶平均用電度數),
               colour = &quot;black&quot;, size = 0.5) +
  scale_fill_gradient(low = &quot;#FFFFB2&quot;, high = &quot;#B10026&quot;,
                      limits = c(300, 2500)) +
  theme_bw(base_family = &#39;STHeiti&#39;) + 
  theme(axis.text = element_blank(), ## 移除經緯度
        axis.ticks = element_blank())+
  labs(x = &#39;&#39;, y = &#39;&#39;) ## 移除X跟Y的title</pre>

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>雷達圖</h2></hgroup><article >

</article></slide><slide class=''><hgroup><h2>雷達圖</h2></hgroup><article  id="-1">

<ul>
<li>雷達圖使用時機</li>
<li>套件介紹、安裝</li>
<li>資料整理</li>
<li>圖表設計</li>
</ul>

</article></slide><slide class=''><hgroup><h2>雷達圖使用時機</h2></hgroup><article >

<div style="float:left;width:48%;">
<div id="htmlwidget-6028" style="width:100%;height:500px;" class="highchart html-widget"></div>
<script type="application/json" data-for="htmlwidget-6028">{"x":{"hc_opts":{"title":{"text":"第5群 - 單身小資女族"},"credits":{"enabled":false},"exporting":{"enabled":false},"plotOptions":{"series":{"turboThreshold":0}},"chart":{"polar":true,"type":"line","height":"400","width":"400"},"xAxis":{"categories":["女男比","平均教育程度","扶老比","有偶比例","每戶平均用電度數","綜合所得中位數"],"tickmarkPlacement":"on","lineWidth":0},"yAxis":{"gridLineInterpolation":"polygon","lineWidth":0,"min":0,"max":1},"series":[{"name":"第5群 - 單身小資女族","data":[0.760575016523463,0.442355567001459,0.516549528558837,0.324203974761624,0.682102572429006,0.254925181364136],"pointPlacement":"on","color":"#FB9A99"},{"name":"各群平均","data":[0.520660295801657,0.498234276805767,0.52524182564392,0.453711339078422,0.561886024869105,0.389589320342519],"pointPlacement":"on","color":"#474747"}]},"theme":null,"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","drillUpText":"Back to {series.name}","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"thousandsSep":" ","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":[],"debug":false},"evals":[],"jsHooks":[]}</script></div>

<div style="float:left;width:48%;">
<h3>

Tips:

</h3>

<ul>
<li>需要比較<strong>群</strong>的特性

<ul>
<li>發現第五群相較於<strong>整體</strong>，女性比例高、綜合所得偏低、用電量高、有偶比例低</li>
<li>這不就是單身小資女嗎！！？ &#8212;&gt; <strong>輪廓</strong></li>
<li>這群包含哪些里呢？</li>
<li><img src="http://attach.azureedge.net/newsimages/2014/04/23/71292-XXL.jpg" width="300px"></li>
</ul></li>
</ul></div>

</article></slide><slide class=''><hgroup><h2>雷德圖：highcharter 套件</h2></hgroup><article  id="highcharter-">

<ul>
<li><a href='http://jkunst.com/highcharter/oldindex.html#introduction' title=''>highcharter for R 官方</a></li>
<li>包含許多類型的圖

<ul>
<li>Line chart, Pie chart, Bar chart, Histogram, Radar chart</li>
</ul></li>
<li>原身是<strong>Javascrip</strong>，<strong>互動式</strong>視覺化專用

<ul>
<li>熟悉JavaScript會比較吃香</li>
<li><a href='http://api.highcharts.com/highcharts' title=''>參數設定查詢</a></li>
</ul></li>
<li>善用<code>help(..)</code></li>
</ul>

<p>套件安裝：</p>

<pre class = 'prettyprint lang-r'>install.packages(&quot;highcharter&quot;)</pre>

</article></slide><slide class=''><hgroup><h2>Highchart 基本架構</h2></hgroup><article  id="highchart-">

<div align="center">
<p><img src="img/highchart.png" width="1000px"></p></div>

</article></slide><slide class=''><hgroup><h2>Highchart 基本使用</h2></hgroup><article  id="highchart-">

<p>感受Highchart繪圖方式：</p>

<ul>
<li><code>highchart</code> : 建立一個Hihghchart, <code>?highchart</code></li>
<li><code>hc_title</code> : 增加title</li>
<li><code>hc_add_series</code> : 通常擺放資料, ?hc_add_series</li>
<li><code>hc_xAxis</code> : X軸設定</li>
</ul>

<pre class = 'prettyprint lang-r'>## 試著漸層式執行以下程式碼
hc &lt;- highchart()
hc
hc &lt;- hc_title(hc, text = &quot;A nice chart&quot;)
hc
hc &lt;- hc_add_series(hc, data = c(7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 
                                26.5, 23.3, 18.3, 13.9, 9.6))
hc</pre>

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>Highchart 練習時間 ！(5 mins)</h2></hgroup><article  id="highchart--5-mins">

</article></slide><slide class=''><hgroup><h2>Highchart 基本練習</h2></hgroup><article  id="highchart-">

<ul>
<li>將上一頁的程式碼利用 <code>%&gt;%</code> 進行改寫，一鼓作氣到底</li>
<li>加入副標題： <code>This is a subtitle</code></li>
<li>將<code>X軸</code>命名為<code>X Axis</code>、 <code>Y軸</code>命名為<code>Y Axis</code>。<code>help(hc_xAxis)</code></li>
<li>在加入一條線，資料為: <code>c(6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6, 7.0)</code></li>
</ul>

<div align="center">
<div id="htmlwidget-1943" style="width:100%;height:500px;" class="highchart html-widget"></div>
<script type="application/json" data-for="htmlwidget-1943">{"x":{"hc_opts":{"title":{"text":"A nice chart"},"credits":{"enabled":false},"exporting":{"enabled":false},"plotOptions":{"series":{"turboThreshold":0}},"subtitle":{"text":"This is a subtitle"},"xAxis":{"title":{"text":"X Axis"}},"yAxis":{"title":{"text":"Y Axis"}},"series":[{"data":[7,6.9,9.5,14.5,18.2,21.5,25.2,26.5,23.3,18.3,13.9,9.6]},{"data":[6.9,9.5,14.5,18.2,21.5,25.2,26.5,23.3,18.3,13.9,9.6,7]}],"chart":{"width":"300","height":"300"}},"theme":null,"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","drillUpText":"Back to {series.name}","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"thousandsSep":" ","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":[],"debug":false},"evals":[],"jsHooks":[]}</script></div>

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<pre class = 'prettyprint lang-r'>highchart() %&gt;% 
  hc_title(text = &#39;A nice chart&#39;) %&gt;% 
  hc_subtitle(text = &#39;This is a subtitle&#39;) %&gt;% 
  hc_xAxis(title = list(text = &#39;X Axis&#39;)) %&gt;% 
  hc_yAxis(title = list(text = &#39;Y Axis&#39;)) %&gt;% 
  hc_add_series(data = c(7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 
                                26.5, 23.3, 18.3, 13.9, 9.6)) %&gt;% 
  hc_add_series(data = c(6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 
                             26.5, 23.3, 18.3, 13.9, 9.6,7.0 ))</pre>

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<br><br><br><br><br>

<div align="center">
<p><hh>專案範例<br>運用Highchart描述各群<strong>輪廓</strong></hh></p></div>

</article></slide><slide class=''><hgroup><h2>資料匯入</h2></hgroup><article >

<ul>
<li>打開在瀏覽器上輸入下面網址，看看是什麼！？</li>
<li>rowMeans : 計算列平均值。 後面會用到</li>
</ul>

<pre class = 'prettyprint lang-r'>## 別忘了先檢查以下流程喔！ setwd() getwd() head() tail() str() ...
data.url &lt;- &#39;https://raw.githubusercontent.com/unityculture/DSP2016_DataCamp/master/data/20160613_Radar_plot.csv&#39;
radar.data &lt;- read.csv(file = data.url)
## 計算整理平均
radar.data$mean &lt;- rowMeans(x = radar.data[,-1])</pre>

</article></slide><slide class=''><hgroup><h2>資料說明</h2></hgroup><article >

<ul>
<li>index : 人口特性指標</li>
<li>X1 ~ X8 : 代表群1至群8

<ul>
<li>每一里都會對應至某一群</li>
<li>每一群包含的里數都不同</li>
</ul></li>
<li>物以類聚</li>
</ul>

<pre class = 'prettyprint lang-r'>head(radar.data)</pre>

<div id="htmlwidget-7465" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-7465">{"x":{"data":[["1","2","3","4","5","6"],["女男比","平均教育程度","扶老比_log","有偶比例","每戶平均用電度數_log","綜合所得中位數_log"],[0.272466903002263,0.137626587793984,0.610220607333308,0.227751106061217,0.426575258145798,0.124434720742731],[0.552394400048068,0.746946675095014,0.340311845503325,0.809993143264232,0.611037047559653,0.770005839008807],[0.609313370146899,0.801202650649786,0.712749058764887,0.577372565266684,0.620769611826296,0.608722860537596],[0.43086256558387,0.299747024329964,0.522667006733445,0.303722141085217,0.511673219039652,0.202092861151155],[0.760575016523463,0.442355567001459,0.516549528558837,0.324203974761624,0.682102572429006,0.254925181364136],[0.553307997356246,0.620332217357713,0.586524031288357,0.508572131015036,0.597197150310815,0.465288903605204],[0.493361794678676,0.471392893291569,0.594303998942079,0.392236322053638,0.556066723916957,0.31899470920469],[0.493000319073774,0.466270598926651,0.318608528027119,0.485839329119728,0.489666615724663,0.372249487125829],[0.520660295801657,0.498234276805767,0.52524182564392,0.453711339078422,0.561886024869105,0.389589320342519]],"container":"<table class=\"compact\">\n  <thead>\n    <tr>\n      <th> \u003c/th>\n      <th>index\u003c/th>\n      <th>X1\u003c/th>\n      <th>X2\u003c/th>\n      <th>X3\u003c/th>\n      <th>X4\u003c/th>\n      <th>X5\u003c/th>\n      <th>X6\u003c/th>\n      <th>X7\u003c/th>\n      <th>X8\u003c/th>\n      <th>mean\u003c/th>\n    \u003c/tr>\n  \u003c/thead>\n\u003c/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nvar d = parseFloat(data[2]); $(this.api().cell(row, 2).node()).html(isNaN(d) ? '' : d.toFixed(2));\nvar d = parseFloat(data[3]); $(this.api().cell(row, 3).node()).html(isNaN(d) ? '' : d.toFixed(2));\nvar d = parseFloat(data[4]); $(this.api().cell(row, 4).node()).html(isNaN(d) ? '' : d.toFixed(2));\nvar d = parseFloat(data[5]); $(this.api().cell(row, 5).node()).html(isNaN(d) ? '' : d.toFixed(2));\nvar d = parseFloat(data[6]); $(this.api().cell(row, 6).node()).html(isNaN(d) ? '' : d.toFixed(2));\nvar d = parseFloat(data[7]); $(this.api().cell(row, 7).node()).html(isNaN(d) ? '' : d.toFixed(2));\nvar d = parseFloat(data[8]); $(this.api().cell(row, 8).node()).html(isNaN(d) ? '' : d.toFixed(2));\nvar d = parseFloat(data[9]); $(this.api().cell(row, 9).node()).html(isNaN(d) ? '' : d.toFixed(2));\nvar d = parseFloat(data[10]); $(this.api().cell(row, 10).node()).html(isNaN(d) ? '' : d.toFixed(2));\n}"},"callback":null,"filter":"none"},"evals":["options.rowCallback"],"jsHooks":[]}</script>

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<ul>
<li><code>polar = TRUE</code> : 雷達圖</li>
</ul>

<pre class = 'prettyprint lang-r'>hc &lt;-
  highchart() %&gt;% 
  hc_chart(polar = TRUE, type = &quot;line&quot;) %&gt;% 
  hc_title(text = &quot;第5群 - 單身女小資女族&quot;) %&gt;% 
  hc_xAxis(categories = c(&#39;女男比&#39;,&#39;平均教育程度&#39;,&#39;扶老比&#39;,
                          &#39;有偶比例&#39;,&#39;每戶平均用電度數&#39;,&#39;綜合所得中位數&#39;),
           tickmarkPlacement = &#39;on&#39;,
           lineWidth = 0) %&gt;% 
  hc_yAxis(gridLineInterpolation = &#39;polygon&#39;,
           lineWidth = 0,
           min = 0, max = 1)</pre>

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<ul>
<li><code>col.raw</code> : 這些色碼可以怎麼得到呢？(RCcolorBrewer)</li>
<li><code>hc_series</code> : series設定</li>
</ul>

<pre class = 'prettyprint lang-r'>col.raw &lt;- c(&quot;#A6CEE3&quot;,&quot;#1F78B4&quot;,&quot;#B2DF8A&quot;,&quot;#33A02C&quot;,&quot;#FB9A99&quot;,
             &quot;#E31A1C&quot;,&quot;#FDBF6F&quot;,&quot;#FF7F00&quot;,&quot;#CAB2D6&quot;,&quot;#6A3D9A&quot;)
hc %&gt;% 
  hc_series(
    list(
      name = &quot;第1群 - 高所得已婚知識份子族群&quot;,
      data = radar.data[,c(6)],
      pointPlacement = &#39;on&#39;,color=col.raw[5]),
    list(
      name = &quot;各群平均&quot;,
      data = radar.data[,c(10)],
      pointPlacement = &#39;on&#39;,color=&#39;#474747&#39;))</pre>

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>互動式圖表：Plotly</h2></hgroup><article  id="plotly">

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<br><br><br><br><br>

<div align="center">
<p><hh>專案範例：運用Plotly進行探索性資料分析</hh></p></div>

</article></slide><slide class=''><hgroup><h2>資料準備</h2></hgroup><article >

<pre class = 'prettyprint lang-r'>## 別忘了先檢查以下流程喔！ setwd() getwd() head() tail() str() ...
plotly_data &lt;- 
  read.csv(&#39;https://raw.githubusercontent.com/unityculture/DSP2016_DataCamp/master/data/20160617_plotly_data.csv&#39;)
plotly_data %&gt;% head</pre>

<pre >      行政區域 綜合所得中位數 平均教育程度  有偶比例 女男比    扶老比
1 北投區八仙里            647       1.7584 0.2906174 1.0442 0.1636575
2 北投區大同里            649       1.7444 0.2952138 1.0227 0.1717187
3 北投區大屯里            570       1.1708 0.2731650 0.8857 0.2290663
4 北投區稻香里            629       1.6086 0.2839104 0.9881 0.1738075
5 北投區東華里            688       1.9380 0.3003697 1.1290 0.1840073
6 北投區豐年里            604       1.4208 0.2877281 1.0585 0.1776487
  每戶平均用電度數 cluster
1          1052.76       4
2          1044.28       4
3          1129.64       1
4           888.20       4
5           990.55       7
6           789.07       4</pre>

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<br><br><br><br><br>

<div align="center">
<p><hh>問題：教育程度的地區，是否較有節電的概念呢？</hh></p></div>

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<p><img src="index_files/figure-html/unnamed-chunk-35-1.png" width="720" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<pre class = 'prettyprint lang-r'>plotly_data %&gt;% 
  ggplot(aes(x=平均教育程度,y=每戶平均用電度數))+
  geom_point(alpha=0.5,aes(text = paste(&#39;地區:&#39;,行政區域 )))+
  stat_smooth(method = &#39;lm&#39;,formula = y ~ x,se=F,size=0.5)+
  theme_bw(base_family = &#39;STHeiti&#39;)+
  theme(plot.title = element_text(size=rel(1.3)),
        axis.title.x = element_text(size = rel(2)),
        axis.title.y = element_text(size = rel(2))) -&gt; p1
ggplotly(p1)</pre>

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<br><br><br><br><br>

<div align="center">
<p><hh>分群分開來看呢？</hh></p></div>

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<p><img src="index_files/figure-html/unnamed-chunk-37-1.png" width="720" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<pre class = 'prettyprint lang-r'>plotly_data %&gt;% 
  mutate(cluster = as.factor(cluster)) %&gt;% 
  ggplot(aes(x=平均教育程度,y=每戶平均用電度數,group=cluster,colour=cluster))+
  geom_point(alpha=0.5,aes(text = paste(&#39;地區:&#39;,行政區域 )))+
  stat_smooth(method = &#39;lm&#39;,formula = y ~ x,se=F,size=0.5)+
  theme_bw(base_family = &#39;STHeiti&#39;)+
  theme(plot.title = element_text(size=rel(1.3)),
        axis.title.x = element_text(size = rel(2)),
        axis.title.y = element_text(size = rel(2))) -&gt; p1
ggplotly(p1)</pre>

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article >

<br><br><br><br><br>

<div align="center">
<p><hh>Thank You!</hh></p></div></article></slide>


  <slide class="backdrop"></slide>

</slides>

<script src="index_files/ioslides-13.5.1/js/modernizr.custom.45394.js"></script>
<script src="index_files/ioslides-13.5.1/js/prettify/prettify.js"></script>
<script src="index_files/ioslides-13.5.1/js/prettify/lang-r.js"></script>
<script src="index_files/ioslides-13.5.1/js/prettify/lang-yaml.js"></script>
<script src="index_files/ioslides-13.5.1/js/hammer.js"></script>
<script src="index_files/ioslides-13.5.1/js/slide-controller.js"></script>
<script src="index_files/ioslides-13.5.1/js/slide-deck.js"></script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!-- map slide visiblity events into shiny -->
<script>
  (function() {
    if (window.jQuery) {
       window.jQuery(document).on('slideleave', function(e) {
         window.jQuery(e.target).trigger('hidden');
      });
       window.jQuery(document).on('slideenter', function(e) {
         window.jQuery(e.target).trigger('shown');
      });
    }
  })();
</script>

</body>
</html>
